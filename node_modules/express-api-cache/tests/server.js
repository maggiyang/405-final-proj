var express = require('express');
var bodyParser = require('body-parser');
var app = express();
var redis = require("redis"),
    client = redis.createClient();

var expressApiCache = require('../');

app.use(bodyParser());
app.use(express.Router());
app.use(expressApiCache.apiCache(client));

app.get('/', function(req, res) {
  res.send(200);
})

app.get('/api/test1', function(req, res) {  
  var opts = {
    client: client,
    query: '/api/test1',
    data: 'test1',
    time: 30
  }

  expressApiCache.cacheValue(opts, function(err, data) {
    if (err) console.log(err);
    else res.send(200);
  });

})

app.post('/api/test2', function(req, res) {
  var opts = {
    client: client,
    query: '/api/test2',
    data: 'test2',
    time: 30
  }

  expressApiCache.cacheValue(opts, function(err, data) {
    if (err) console.log(err);
    else res.send(200);
  });

})

app.listen(3000);